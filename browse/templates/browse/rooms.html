{% load static %}

<link rel="stylesheet" href="{% static 'css/rooms.css' %}">
<a href="/home/"> Home </a>
<div class="logout-top">
    <a href="{% url 'login:user-logout' %}" class="logout-button logout-button">Logout</a>
</div>
<h1>Browse Rooms</h1>

<div class="main-container">
    <!-- Filter Panel -->
    <div class="filter-panel">
<fieldset>
    <legend><h3>Filter</h3></legend>
    <label>Regions</label>
    <br>
    <form id="filters" action="{% url 'browse:browse' %}" method="get">
    {% if region_list %}
        {% for value, label in region_list %}
            <label><input type="checkbox" name="region" id="{{ value }}" value="{{ value }}" {% if value in selected_regions %} checked {% endif %}>{{ label }}</label>
        {% endfor %}
    {% else %}
        <p id="no_regions" value="none">No regions to display</p>
    {% endif %}

    <br><br>

    <label>Buildings</label>
    <br>
    {% if building_list %}
        {% for building in building_list %}
            <label><input type="checkbox" id="{{ building.name }}" name="building" value="{{ building.name }}" {% if building.name in selected_buildings %} checked {% endif %}>{{ building.display_building_name }}</label> 
        {% endfor %}
    {% else %}
        <p id="no_buildings" value="none">No buildings to display</p>
    {% endif %}

    <br><br>

    <label>Floors</label>
    <br>
    {% if floor_list %}
        {% for value, label in floor_list %}
            <label><input type="checkbox" name="floor" value="{{ value }}" {% if value in selected_floors %} checked {% endif %}>{{ label }}</label>
        {% endfor %}
    {% else %}
        <p id="no_floors" value="none">No floors to display</p>
    {% endif %}

    <br><br>

    <label>Room Size</label>
    <br>
    {% if size_list %}
        {% for value, label in size_list %}
            <label><input type="checkbox" name="size" value="{{ value }}" {% if value in selected_sizes %} checked {% endif %}>{{ label }}</label>
        {% endfor %}
    {% else %}
        <p id="no_sizes" value="none">No sizes to display</p>
    {% endif %}

    <br><br>

    <div id="additional_filters">
        <label>Additional Filters</label>
        <br>
        <label><input type="checkbox" name="sub_free" value="True" {% if sub_free %} checked {% endif %}>Building is sub free</label>
        <label><input type="checkbox" name="elevator" value="True" {% if elevator %} checked {% endif %}>Building has elevator</label>
        <label><input type="checkbox" name="women_only" value="True" {% if women_only %} checked {% endif %}>Building is for women only</label>
        <label><input type="checkbox" name="srd" value="True" {% if srd %} checked {% endif %}>Special Room Draw</label>
        <label><input type="checkbox" name="ca" value="True" {% if ca %} checked {% endif %}>CA Room</label>
    </div>

    <br><br>
    
    <label>Sort by Rating</label>
    <br>
    <select name="rating">
            <option value="" {% if rating == "" %}selected{% endif %}>Default</option>
            <option value="desc" {% if rating == "desc" %}selected{% endif %}>Rating: High to Low</option>
            <option value="asc" {% if rating == "asc" %}selected{% endif %}>Rating: Low to High</option>
        </select>
        <br><br>
    <button id="submit_filters" type="submit">Apply Filters</button>
    <a href="{% url 'browse:browse' %}" class="btn">Clear Filters</a>


    </form>
</fieldset>
</div>

<div class="room-list">
<h2>Available Rooms ({{ room_list.count }})</h2>

{% if room_list %}
    <ul id="room_list">
    {% for room in room_list %}
        <li>
            <a href="/browse/{{ room.building.name }}/{{ room.number }}">{{ room.building.name }} {{ room.number }}</a>| 
            <span class="star-rating" style="--rating: {{ room.avg_rating }};"></span>
            [{{ room.avg_rating }} from {{room.reviews.count}} review(s)] | {{room.get_num_occupants_display}} {% if room.srd %}| Special Room Draw {% endif %} {% if room.ca %}| CA Room {% endif %}
        </li>
    {% endfor %}
    </ul>
{% else %}
<p>No rooms are available</p>
{% endif %}
</div>